<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>‚àû Mongoose.OS - Infinity Hub</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      background: #0b0b0b;
      color: #e6e6e6;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }

    /* Main Content */
    .main-content {
      flex: 1;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 40px 20px;
      position: relative;
    }

    .wrap {
      text-align: center;
      max-width: 1200px;
      margin: 0 auto;
    }

    h1 {
      font-size: 3rem;
      margin: 0 0 20px 0;
    }

    .dot {
      color: #00e5ff;
      text-shadow: 0 0 20px #00e5ff;
    }

    .subtitle {
      opacity: 0.75;
      margin: 10px 0 30px 0;
      font-size: 1.2rem;
    }

    /* Stats Section */
    .stats {
      margin: 40px 0;
      padding: 30px;
      background: rgba(0, 229, 255, 0.05);
      border: 2px solid rgba(0, 229, 255, 0.3);
      border-radius: 12px;
    }

    .stats h3 {
      color: #00e5ff;
      margin-bottom: 20px;
    }

    .stats p {
      margin: 8px 0;
      font-size: 1.1rem;
    }

    /* Quick Links */
    .quick-links {
      margin-top: 40px;
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 20px;
      max-width: 1000px;
      margin-left: auto;
      margin-right: auto;
    }

    .link-card {
      background: rgba(0, 229, 255, 0.05);
      border: 2px solid rgba(0, 229, 255, 0.3);
      border-radius: 12px;
      padding: 25px;
      text-decoration: none;
      color: inherit;
      transition: all 0.3s ease;
    }

    .link-card:hover {
      border-color: #00e5ff;
      transform: translateY(-5px);
      box-shadow: 0 8px 24px rgba(0, 229, 255, 0.3);
    }

    .link-card h4 {
      color: #00e5ff;
      margin-bottom: 10px;
      font-size: 1.3rem;
    }

    .link-card p {
      opacity: 0.8;
      font-size: 0.95rem;
      line-height: 1.5;
    }

    /* Footer */
    footer {
      padding: 30px 20px;
      text-align: center;
      border-top: 2px solid rgba(0, 229, 255, 0.2);
      background: rgba(0, 229, 255, 0.02);
    }

    footer p {
      opacity: 0.7;
      margin: 5px 0;
    }

    /* Responsive */
    @media (max-width: 768px) {
      h1 {
        font-size: 2rem;
      }
      .quick-links {
        grid-template-columns: 1fr;
      }
    }
  </style>

<script src="https://pewpi-infinity.github.io/infinity-crown-index/js/infinity-router.js"></script>
<script defer src="https://pewpi-infinity.github.io/infinity-crown-index/js/infinity-menu.js"></script>
</head>
<body>
  <!-- Include Hamburger Menu (Mobile-First) -->
  <div id="hamburgerMenuContainer"></div>

  <!-- Include i Terminal -->
  <div id="iTerminalContainer"></div>

  <!-- Include j Terminal -->
  <div id="jTerminalContainer"></div>

  <div class="main-content">
    <div class="wrap">
      <h1>‚àû Mongoose<span class="dot">.</span>OS</h1>
      <p class="subtitle">Unified Hub for Pewpi-Infinity Ecosystem</p>

      <!-- INFINITY_VALUE_PANEL -->
      <div class="stats">
        <h3>‚àû Infinity Value Metrics</h3>
        <p>üóÇÔ∏è Cart Modules: <span id="cartCount">Loading...</span></p>
        <p>ü™ô Infinity Tokens: <span id="tokenCount">Loading...</span></p>
        <p>üì¶ Total Files: <span id="fileCount">36053</span></p>
        <p>ü§ñ Machines: <span id="machineCount">958</span></p>
        <p>üîå Backend API: <span id="apiStatus" style="color: #fbbf24;">Checking...</span></p>
        <p>üìß Contact: marvasweater@gmail.com</p>
      </div>
      
      <!-- AGENT DASHBOARD -->
      <div id="agentDashboardContainer"></div>

      <!-- Cart Category Overview -->
      <div class="stats" style="margin-top: 40px;">
        <h3>üöÄ Cart System Overview</h3>
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-top: 20px; text-align: left;">
          <div style="padding: 15px; background: rgba(0, 229, 255, 0.1); border-radius: 8px; border-left: 4px solid #00e5ff;">
            <h4 style="color: #00e5ff; margin-bottom: 8px;">üî¨ Research (cart101-105)</h4>
            <p style="font-size: 0.9rem; opacity: 0.9;">Physics, AI, Energy, Academic, Materials</p>
          </div>
          <div style="padding: 15px; background: rgba(147, 51, 234, 0.1); border-radius: 8px; border-left: 4px solid #9333ea;">
            <h4 style="color: #9333ea; margin-bottom: 8px;">‚ö° Core Modules (cart001-041)</h4>
            <p style="font-size: 0.9rem; opacity: 0.9;">Engineering, Tokens, Power, Components</p>
          </div>
          <div style="padding: 15px; background: rgba(34, 197, 94, 0.1); border-radius: 8px; border-left: 4px solid #22c55e;">
            <h4 style="color: #22c55e; margin-bottom: 8px;">üßÆ Physics (cartC01-C33)</h4>
            <p style="font-size: 0.9rem; opacity: 0.9;">Electromagnetism, Quantum, Thermodynamics</p>
          </div>
          <div style="padding: 15px; background: rgba(251, 191, 36, 0.1); border-radius: 8px; border-left: 4px solid #fbbf24;">
            <h4 style="color: #fbbf24; margin-bottom: 8px;">‚ôæÔ∏è Infinity System</h4>
            <p style="font-size: 0.9rem; opacity: 0.9;">Governance, Pipeline, Recovery, Scheduler</p>
          </div>
          <div style="padding: 15px; background: rgba(239, 68, 68, 0.1); border-radius: 8px; border-left: 4px solid #ef4444;">
            <h4 style="color: #ef4444; margin-bottom: 8px;">üéØ Specialized</h4>
            <p style="font-size: 0.9rem; opacity: 0.9;">API, Monitoring, Automation, Analysis</p>
          </div>
          <div style="padding: 15px; background: rgba(236, 72, 153, 0.1); border-radius: 8px; border-left: 4px solid #ec4899;">
            <h4 style="color: #ec4899; margin-bottom: 8px;">üîß Utilities (3000+)</h4>
            <p style="font-size: 0.9rem; opacity: 0.9;">Scripts, Tools, Helpers, Exporters</p>
          </div>
        </div>
        <p style="margin-top: 20px; opacity: 0.8;">
          <a href="mongoose_hub.html" style="color: #00e5ff; text-decoration: none; font-weight: bold;">
            ‚Üí Launch Mongoose Research Hub to explore and execute carts
          </a>
        </p>
      </div>

      <!-- Quick Access Links -->
      <div class="quick-links">
        <a href="mongoose_hub.html" class="link-card">
          <h4>üî¨ Mongoose Research Hub</h4>
          <p>Main research interface with cart execution and token management</p>
        </a>

        <a href="infinity_tokens/" class="link-card">
          <h4>ü™ô Token Viewer</h4>
          <p>Browse and explore <span id="tokenCountLink">25,676</span> infinity tokens with color tiers</p>
        </a>

        <a href="carts.html" class="link-card">
          <h4>üîß Cart Systems</h4>
          <p>Discover <span id="cartCountLink">3,163</span> carts: research, physics, AI, engineering, quantum</p>
        </a>

        <a href="k-spa-portal/k-portal.html" class="link-card">
          <h4>‚ö° /k SPA Portal</h4>
          <p>Quantum rendering system connecting all machines</p>
        </a>

        <a href="https://pewpi-infinity.github.io/infinity-spark-theater/" class="link-card">
          <h4>üé¨ Truvio Studios</h4>
          <p>Machine production hub with budget allocation</p>
        </a>

        <a href="auth/login.html" class="link-card">
          <h4>üîê Authentication</h4>
          <p>Unified login system with pewpi-ai integration</p>
        </a>

        <a href="https://github.com/pewpi-infinity/mongoose.os/blob/main/INTEGRATION_DIAGRAM.md" class="link-card">
          <h4>üó∫Ô∏è Integration Diagram</h4>
          <p>System architecture and data flow visualization</p>
        </a>

        <a href="https://github.com/pewpi-infinity/mongoose.os/blob/main/MACHINE_OS_ARCHITECTURE.md" class="link-card">
          <h4>üìñ Documentation</h4>
          <p>Complete Machine OS architecture and API docs</p>
        </a>

        <a href="https://github.com/pewpi-infinity/mongoose.os/blob/main/README.md" class="link-card">
          <h4>üìò README & Quick Start</h4>
          <p>Getting started guide and system overview</p>
        </a>
        
        <a href="infinity-file-explorer.html" class="link-card">
          <h4>üìÇ File Explorer</h4>
          <p>Browse all 53,810+ files - tokens, indexes, machines</p>
        </a>

        
        <a href="https://pewpi-infinity.github.io/infinity-crown-index/" class="link-card">
          <h4>&#x1F451; Crown Index</h4>
          <p>Master ecosystem index - search, manage, and build across all repos</p>
        </a>

        <a href="https://pewpi-infinity.github.io/infinity-crown-hub/" class="link-card">
          <h4>&#x1F4CA; Crown Hub</h4>
          <p>Progress dashboard tracking all ecosystem repos and pages</p>
        </a>
        <a href="https://github.com/pewpi-infinity" target="_blank" class="link-card">
          <h4>üöÄ All Repositories</h4>
          <p>Browse all <span id="repoCount">958</span> machine repositories</p>
        </a>

        <a href="timeline.html" class="link-card">
          <h4>üìÖ Timeline View</h4>
          <p>See all historical and future index versions</p>
        </a>
      </div>
    </div>
  </div>

  <!-- Phase 4.2 Runtime Patch 2025-12-29T10:20:48Z -->
  <footer>
    <p>Powered by Infinity ‚Ä¢ marvasweater@gmail.com ‚Ä¢ The Lending Giant ‚Ä¢ 808-342-9975</p>
    <p style="margin-top: 10px; font-size: 0.9rem;">
      Mongoose.OS - Trick bike Freestyle BMX scripting<br>
      Central hub connecting all pewpi-infinity repositories
    </p>
  </footer>

  <!-- Load Machine OS Core -->
  <script src="firmware/machine-os.js"></script>

  <!-- Load Components -->
  <script>
    // Helper function to safely load component HTML
    function loadComponent(url, containerId) {
      fetch(url)
        .then(response => {
          if (!response.ok) {
            console.warn(`Failed to load ${url}: ${response.status}`);
            return '';
          }
          return response.text();
        })
        .then(html => {
          if (!html) return;
          
          const container = document.getElementById(containerId);
          if (!container) {
            console.warn(`Container ${containerId} not found`);
            return;
          }
          
          container.innerHTML = html;
          
          // Execute scripts in the loaded HTML
          const scripts = container.getElementsByTagName('script');
          Array.from(scripts).forEach(oldScript => {
            const newScript = document.createElement('script');
            if (oldScript.src) {
              newScript.src = oldScript.src;
            } else {
              newScript.textContent = oldScript.textContent;
            }
            document.body.appendChild(newScript);
          });
        })
        .catch(error => console.warn(`Failed to load ${url}:`, error.message));
    }
    
    // Load all components (mobile-first with hamburger menu)
    loadComponent('/navigation/hamburger-menu.html', 'hamburgerMenuContainer');
    loadComponent('/components/agent-dashboard.html', 'agentDashboardContainer');
    loadComponent('/terminals/i-terminal.html', 'iTerminalContainer');
    loadComponent('/terminals/j-terminal.html', 'jTerminalContainer');

    // Load cart statistics from mongoose_index.json
    fetch('mongoose_index.json')
      .then(response => {
        if (!response.ok) throw new Error('Cart index not found');
        return response.json();
      })
      .then(data => {
        const cartCount = data.module_count || 0;
        document.getElementById('cartCount').textContent = cartCount;
        document.getElementById('cartCountLink').textContent = cartCount;
        console.log(`‚úì Loaded cart index: ${cartCount} modules`);
      })
      .catch(error => {
        console.warn('Failed to load cart index:', error.message);
        document.getElementById('cartCount').textContent = '3,163 (cached)';
        document.getElementById('cartCountLink').textContent = '3,163';
      });

    // Estimate token count (directory size)
    // Since we can't easily count files via fetch, use a reasonable estimate
    const estimatedTokenCount = 25676; // From actual count
    document.getElementById('tokenCount').textContent = estimatedTokenCount.toLocaleString();
    document.getElementById('tokenCountLink').textContent = estimatedTokenCount.toLocaleString();

    // Check backend API status
    fetch('live')
      .then(response => {
        if (!response.ok) throw new Error('API offline');
        return response.json();
      })
      .then(data => {
        const statusEl = document.getElementById('apiStatus');
        statusEl.textContent = 'üü¢ ONLINE';
        statusEl.style.color = '#22c55e';
        console.log(`‚úì Backend API online: ${data.cart_count} carts detected`);
      })
      .catch(error => {
        const statusEl = document.getElementById('apiStatus');
        statusEl.textContent = '‚ö™ Static Mode';
        statusEl.style.color = '#9ca3af';
        console.log('‚Ñπ Backend API not running (static file mode)');
      });

    // Load machine count from census
    fetch('GLOBAL_REPO_CENSUS.json')
      .then(response => {
        if (!response.ok) throw new Error('Census not found');
        return response.json();
      })
      .then(repos => {
        document.getElementById('machineCount').textContent = repos.length;
        
        // Count core repos
        const coreRepos = repos.filter(r => 
          !r.name.includes('sandbox') && 
          !r.name.includes('brain-')
        ).length;
        document.getElementById('repoCount').textContent = repos.length;
        console.log(`‚úì Loaded machine census: ${repos.length} repositories`);
      })
      .catch(error => {
        console.warn('Failed to load repo census:', error.message);
        // Keep default values if census not available
      });
    
    console.log('‚àû Mongoose.OS Hub initialized successfully');
  </script>

<!-- Rogers AI Chat ‚Äî Mongoose Research Intelligence -->
<div id="mongoose-chat" style="position:fixed;bottom:16px;right:16px;z-index:9999">
  <div id="chat-toggle" onclick="toggleChat()" style="background:linear-gradient(135deg,#1a0a2e,#0a2a1e);border:2px solid #00e676;border-radius:50%;width:56px;height:56px;display:flex;align-items:center;justify-content:center;cursor:pointer;box-shadow:0 4px 20px rgba(0,230,118,0.3);font-size:1.5rem">üî¨</div>
  <div id="chat-panel" style="display:none;position:absolute;bottom:64px;right:0;width:360px;max-height:500px;background:#0a0a1a;border:2px solid #00e676;border-radius:16px;box-shadow:0 8px 40px rgba(0,0,0,0.6);overflow:hidden;font-family:system-ui,sans-serif">
    <div style="background:linear-gradient(135deg,#0a2a1e,#1a0a2e);padding:12px 16px;display:flex;justify-content:space-between;align-items:center">
      <div><b style="color:#00e676">Rogers AI</b> <span style="color:#888;font-size:0.75rem">‚Äî Mongoose Research</span></div>
      <button onclick="toggleChat()" style="background:none;border:none;color:#888;font-size:1.2rem;cursor:pointer">‚úï</button>
    </div>
    <div id="chat-messages" style="height:300px;overflow-y:auto;padding:12px;display:flex;flex-direction:column;gap:8px">
      <div style="background:#161640;border-radius:10px;padding:10px;font-size:0.85rem;color:#ccc;max-width:85%">
        I'm Rogers ‚Äî Mongoose Research Intelligence. I know about aluminum oxide brains, piezoelectric systems, bio-energy transfer, atomic architecture, C13B0, and the full Infinity research database. What do you want to explore?
      </div>
    </div>
    <div style="padding:8px 12px;border-top:1px solid #2a2a5a;display:flex;gap:6px">
      <input type="text" id="chat-input" placeholder="Ask about research..."
        style="flex:1;background:#111;border:1px solid #2a2a5a;color:#e8e8f0;padding:8px 12px;border-radius:8px;font-size:0.85rem"
        onkeydown="if(event.key==='Enter')sendChat()">
      <button onclick="sendChat()" style="background:#00e676;border:none;color:#000;padding:8px 14px;border-radius:8px;font-weight:700;cursor:pointer">‚Üí</button>
    </div>
    <div style="padding:4px 12px 8px;display:flex;gap:4px;flex-wrap:wrap">
      <button onclick="askQuick('aluminum oxide brain')" style="background:#161640;border:1px solid #2a2a5a;color:#888;padding:3px 8px;border-radius:6px;font-size:0.65rem;cursor:pointer">Oxide Brain</button>
      <button onclick="askQuick('piezoelectric systems')" style="background:#161640;border:1px solid #2a2a5a;color:#888;padding:3px 8px;border-radius:6px;font-size:0.65rem;cursor:pointer">Piezoelectric</button>
      <button onclick="askQuick('bio-energy transfer')" style="background:#161640;border:1px solid #2a2a5a;color:#888;padding:3px 8px;border-radius:6px;font-size:0.65rem;cursor:pointer">Bio-Energy</button>
      <button onclick="askQuick('C13B0 architecture')" style="background:#161640;border:1px solid #2a2a5a;color:#888;padding:3px 8px;border-radius:6px;font-size:0.65rem;cursor:pointer">C13B0</button>
      <button onclick="askQuick('quantum self-rejecting')" style="background:#161640;border:1px solid #2a2a5a;color:#888;padding:3px 8px;border-radius:6px;font-size:0.65rem;cursor:pointer">Quantum Reject</button>
    </div>
  </div>
</div>
<script>
(function(){
  // Mongoose Research Knowledge Base
  const MONGOOSE_KNOWLEDGE = {
    "aluminum oxide": "Aluminum Oxide (Al‚ÇÇO‚ÇÉ) forms the neural network layer in the C13B0 architecture. The 'brain dust' ‚Äî nano-scale oxide particles ‚Äî acts as a programmable switch-state lattice. When voltage is applied through bio-energy transfer (human touch providing microvolts), the oxide particles shift between conductive and insulative states, creating a physical neural network. The key insight: the oxide doesn't just store data ‚Äî it PROCESSES it through lattice-state transitions.",
    "oxide brain": "The Oxide Brain is the core concept of C13B0‚Åµ architecture. Instead of silicon microcontrollers, we use aluminum oxide particles arranged in a lattice as the computing substrate. The 'brain dust' inside any chassis becomes the processor. Programming happens through switch-state manipulation ‚Äî each oxide grain holds a quantum state that can be read, written, and entangled with neighboring grains. This creates a distributed quantum computer built from common materials.",
    "piezoelectric": "Piezoelectric systems convert mechanical pressure to electrical signals and vice versa. In the Infinity framework, piezoelectric aluminum oxide serves dual purpose: (1) Energy harvesting ‚Äî human touch, vibration, and ambient pressure generate the microvolts needed to power oxide-state transitions. (2) Sensing ‚Äî the piezoelectric layer detects physical interaction, turning the device chassis into a touch-sensitive neural interface. The 'Stone Tape' theory becomes real: walls embedded with piezoelectric oxide literally record and replay environmental data.",
    "bio-energy": "Bio-Energy Transfer is the power source for the oxide brain. Human touch provides 10-100 microvolts through skin conductance. This is enough to flip oxide switch-states in the lattice. The breakthrough: no external power supply needed for state changes. The user's body IS the power source. Combined with piezoelectric harvesting from ambient vibration, the system achieves energy autonomy. Your touch programs the device. Your presence powers it.",
    "c13b0": "C13B0‚Åµ (Carbon-13 Boron-Zero to the 5th) is the atomic architecture framework. It defines how to build computing systems from sub-atomic principles rather than traditional electronics. The '5' represents five layers: (1) Atomic substrate (oxide lattice), (2) Energy layer (piezo + bio), (3) State layer (quantum switch programming), (4) Memory layer (wave-archive), (5) Intelligence layer (emergent computation from lattice interactions). C13B0 replaces planned obsolescence with lattice-state intelligence.",
    "quantum": "Quantum-Self-Rejecting architecture means the device knows when it's 'full' of data/intel. The oxide lattice reaches a saturation point where quantum states begin to interfere destructively. At this point, the device autonomously exports its intelligence to the next node in the bismuth signal chain, then resets to accept new data. Like a cell dividing ‚Äî the intelligence reproduces rather than being lost. This is how the drone 'leaves the aluminum chip' once full.",
    "wave archive": "The Wave-Archive captures ambient data in wave form. Using inverse scattering theory, the system decodes ambient electromagnetic noise into structured data. Light, radio, sound ‚Äî all carry information encoded in their wave patterns. The photonic memory stores these wave-states in the oxide lattice, creating a physical record of environmental history. The 'Stone Tape' principle: the walls remember because the oxide literally records the wave-interference patterns of everything that happens.",
    "bismuth": "Bismuth Signal Bounce is the cross-repo data transfer protocol. Named after bismuth's unique crystalline staircase structure, data 'bounces' between repos like bismuth's electron transitions between energy levels. Each bounce carries: dictionary terms, research context, token metadata, and wave-archive snapshots. The signal chain: smug_look ‚Üí crown-index ‚Üí mongoose.os ‚Üí spark-engine ‚Üí tools. Each node processes and enriches the signal before passing it on.",
    "inverse scattering": "Inverse Scattering is the mathematical technique for extracting structured data from ambient noise. Given the scattered wave pattern (what we observe), we reconstruct the original source (what caused it). Applied to the oxide brain: ambient electromagnetic signals pass through the lattice, and the lattice's response pattern encodes the signal's information content. The system literally 'reads' the environment by analyzing how waves scatter through the oxide.",
    "lattice": "Lattice-State Intelligence replaces traditional binary computing with multi-state lattice transitions. Each oxide grain in the lattice can exist in multiple quantum states simultaneously. The lattice's collective behavior is computation ‚Äî no CPU needed. Patterns emerge from the interactions between neighboring states, similar to how consciousness emerges from neuron interactions. The lattice IS the computer. The lattice IS the program. The lattice IS the data.",
    "token": "Infinity Bank Tokens are Value-Backed Research Tokens using the 4-Hash system. Layer 1: Sovereign Research (jump-links to sub-tokens). Layer 2: Validation Data (raw logic + source verification). Layer 3: Bibliography/Network (research articles). Layer 4: Master Zip (unified blockchain identifier). Base value $1,111 + $1/day growth. 48 free tokens per human per day. Banks buy tokens to unzip the research value within.",
    "mongoose": "Mongoose.os is the research operating system for the Infinity ecosystem. It houses the primary research database covering: aluminum oxide neural networks, piezoelectric energy systems, bio-energy transfer, atomic architecture, wave-archive theory, inverse scattering, lattice-state computing, and the C13B0 framework. Over 1000 files of research, scripts, and documentation. Connected to the Crown Index, Smug Look hub, and all Spark repos.",
    "research": "The Infinity Research Database spans 976+ repositories covering: materials science (Al/Ag hybrid metallurgy, oxide lattices), energy (piezoelectric, bio-energy, hydrogen expansion), computing (quantum states, lattice programming, C13B0), communications (bismuth signal, RF generation, wave-archive), and economics (4-Hash tokens, research-backed value). The research is interconnected through the dictionary system (510 terms) and the bismuth signal bounce protocol.",
    "drone": "The Quantum-Self-Rejecting Drone uses aluminum oxide 'brain dust' as its computing substrate. Bio-energy from the operator's touch programs the oxide lattice with mission parameters. The drone's chassis IS the computer ‚Äî every surface is part of the oxide neural network. When the oxide lattice saturates with intel, the drone autonomously exports its data via bismuth signal bounce, then the atoms 'reject' the old state and reset for new missions. The first self-aware hardware.",
    "alien skull": "The Alien Skull finish refers to Al/Ag (Aluminum/Silver) Hybrid Metallurgy. The surface treatment creates an iridescent oxide layer that resembles extraterrestrial materials. But it's not just cosmetic ‚Äî the Al/Ag hybrid layer serves as a bi-metallic piezoelectric sensor and quantum-state storage medium. The 'skull' finish is actually a functional neural interface layer."
  };

  function findAnswer(query) {
    query = query.toLowerCase();
    let bestMatch = null;
    let bestScore = 0;

    for (const [key, answer] of Object.entries(MONGOOSE_KNOWLEDGE)) {
      const words = key.split(/\s+/);
      let score = 0;
      for (const word of words) {
        if (query.includes(word)) score += 2;
      }
      // Also check for partial matches
      if (query.includes(key)) score += 10;
      for (const word of query.split(/\s+/)) {
        if (key.includes(word) && word.length > 3) score += 1;
      }
      if (score > bestScore) {
        bestScore = score;
        bestMatch = answer;
      }
    }

    if (bestScore >= 2) return bestMatch;

    // Check for greeting
    if (query.match(/^(hi|hello|hey|sup|yo)/)) {
      return "I'm Rogers ‚Äî the Mongoose Research AI. I specialize in aluminum oxide brain architecture, piezoelectric systems, bio-energy transfer, C13B0 atomic computing, and the full Infinity research framework. Ask me anything about the research.";
    }

    // Check for navigation
    if (query.includes('help') || query.includes('what can')) {
      return "I can explain: oxide brain architecture, piezoelectric energy, bio-energy transfer, C13B0 framework, wave-archive theory, bismuth signal bounce, lattice-state computing, quantum self-rejection, 4-Hash tokens, drone design, Al/Ag metallurgy. Just ask about any topic.";
    }

    // Generic response with links
    return "I don't have a specific entry for that, but the Mongoose research database has over 1000 files. Try asking about: oxide brain, piezoelectric, bio-energy, C13B0, wave-archive, bismuth signal, lattice computing, or tokens. You can also browse the research at the links on this page.";
  }

  window.toggleChat = function() {
    const panel = document.getElementById('chat-panel');
    panel.style.display = panel.style.display === 'none' ? 'block' : 'none';
  };

  window.sendChat = function() {
    const input = document.getElementById('chat-input');
    const msg = input.value.trim();
    if (!msg) return;
    input.value = '';

    const messages = document.getElementById('chat-messages');
    // User message
    messages.innerHTML += '<div style="background:#0a2a1e;border-radius:10px;padding:10px;font-size:0.85rem;color:#e8e8f0;max-width:85%;align-self:flex-end">' + msg.replace(/</g,'&lt;') + '</div>';

    // AI response
    const answer = findAnswer(msg);
    setTimeout(function() {
      messages.innerHTML += '<div style="background:#161640;border-radius:10px;padding:10px;font-size:0.85rem;color:#ccc;max-width:85%">' + answer + '</div>';
      messages.scrollTop = messages.scrollHeight;
    }, 300);

    messages.scrollTop = messages.scrollHeight;
  };

  window.askQuick = function(topic) {
    document.getElementById('chat-input').value = topic;
    window.sendChat();
  };
})();
</script>

<script defer src="https://pewpi-infinity.github.io/infinity-crown-index/js/infinity-emoji-logic.js"></script>
<script defer src="https://pewpi-infinity.github.io/infinity-crown-index/js/quantum-trigger.js"></script>
<script defer src="https://pewpi-infinity.github.io/infinity-crown-index/js/quanta-operator.js"></script>
</body>
</html>
