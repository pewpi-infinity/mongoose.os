<!-- Hamburger Menu Component -->
<style>
  .hamburger-menu {
    position: fixed;
    top: 20px;
    left: 20px;
    z-index: 1000;
  }

  .hamburger-button {
    width: 40px;
    height: 40px;
    background: rgba(0, 229, 255, 0.1);
    border: 2px solid #00e5ff;
    border-radius: 8px;
    cursor: pointer;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    gap: 5px;
    transition: all 0.3s ease;
  }

  .hamburger-button:hover {
    background: rgba(0, 229, 255, 0.2);
    transform: scale(1.05);
  }

  .hamburger-line {
    width: 24px;
    height: 2px;
    background: #00e5ff;
    transition: all 0.3s ease;
  }

  .hamburger-menu.active .hamburger-line:nth-child(1) {
    transform: rotate(45deg) translate(6px, 6px);
  }

  .hamburger-menu.active .hamburger-line:nth-child(2) {
    opacity: 0;
  }

  .hamburger-menu.active .hamburger-line:nth-child(3) {
    transform: rotate(-45deg) translate(6px, -6px);
  }

  .menu-panel {
    position: fixed;
    top: 0;
    left: -400px;
    width: 400px;
    height: 100vh;
    background: rgba(11, 11, 11, 0.98);
    border-right: 2px solid #00e5ff;
    transition: left 0.3s ease;
    overflow-y: auto;
    padding: 80px 20px 20px 20px;
    box-shadow: 2px 0 10px rgba(0, 229, 255, 0.3);
  }

  .hamburger-menu.active .menu-panel {
    left: 0;
  }

  .menu-title {
    color: #00e5ff;
    font-size: 1.5rem;
    font-weight: bold;
    margin-bottom: 20px;
    padding-bottom: 10px;
    border-bottom: 1px solid #00e5ff;
  }

  .repo-link {
    display: block;
    color: #e6e6e6;
    text-decoration: none;
    padding: 12px;
    margin: 8px 0;
    border-radius: 6px;
    background: rgba(0, 229, 255, 0.05);
    border-left: 3px solid transparent;
    transition: all 0.3s ease;
  }

  .repo-link:hover {
    background: rgba(0, 229, 255, 0.15);
    border-left-color: #00e5ff;
    transform: translateX(5px);
  }

  .repo-name {
    font-weight: bold;
    color: #00e5ff;
    display: block;
    margin-bottom: 4px;
  }

  .repo-desc {
    font-size: 0.85rem;
    opacity: 0.8;
  }

  .category-header {
    color: #00e5ff;
    font-size: 0.9rem;
    font-weight: bold;
    margin-top: 20px;
    margin-bottom: 10px;
    padding: 8px 12px;
    background: rgba(0, 229, 255, 0.1);
    border-radius: 6px;
    border-left: 3px solid #00e5ff;
    cursor: pointer;
    display: flex;
    justify-content: space-between;
    align-items: center;
  }

  .category-header:hover {
    background: rgba(0, 229, 255, 0.15);
  }

  .category-count {
    font-size: 0.8rem;
    opacity: 0.7;
  }

  .category-content {
    max-height: 0;
    overflow: hidden;
    transition: max-height 0.3s ease;
  }

  .category-content.expanded {
    max-height: 2000px;
  }

  .category-toggle {
    transition: transform 0.3s ease;
  }

  .category-header.expanded .category-toggle {
    transform: rotate(90deg);
  }

  .menu-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.7);
    opacity: 0;
    visibility: hidden;
    transition: all 0.3s ease;
    z-index: 999;
  }

  .hamburger-menu.active .menu-overlay {
    opacity: 1;
    visibility: visible;
  }
</style>

<div class="hamburger-menu" id="hamburgerMenu">
  <div class="menu-overlay" onclick="toggleMenu()"></div>
  
  <div class="hamburger-button" onclick="toggleMenu()">
    <span class="hamburger-line"></span>
    <span class="hamburger-line"></span>
    <span class="hamburger-line"></span>
  </div>

  <nav class="menu-panel">
    <div class="menu-title">∞ Infinity Repos</div>
    <div id="repoLinks"></div>
  </nav>
</div>

<script>
  // Load repository links from GLOBAL_REPO_CENSUS.json
  async function loadRepoLinks() {
    try {
      const response = await fetch('/GLOBAL_REPO_CENSUS.json');
      const repos = await response.json();
      
      const container = document.getElementById('repoLinks');
      
      // Categorize repos
      const categories = {
        core: [],
        brains: [],
        alphabet: [],
        sandbox: [],
        utility: []
      };
      
      repos.forEach(repo => {
        const name = repo.name.toLowerCase();
        if (name.includes('brain-')) {
          categories.brains.push(repo);
        } else if (name.includes('sandbox-')) {
          categories.sandbox.push(repo);
        } else if (name.match(/^[a-z]$/)) {
          categories.alphabet.push(repo);
        } else if (['mongoose.os', 'z', 'banksy', 'gpt-vector-design', 'i', 'j', 'k', 'infinity-portal', 'infinity_mongoose_bitcoin_research_miner'].includes(name)) {
          categories.core.push(repo);
        } else {
          categories.utility.push(repo);
        }
      });
      
      // Add search/filter
      const searchHTML = `
        <div style="padding: 10px 0; margin-bottom: 10px; border-bottom: 1px solid rgba(0, 229, 255, 0.3);">
          <input type="text" id="repoSearch" placeholder="Search ${repos.length} machines..." 
                 style="width: 100%; padding: 8px; background: rgba(0, 229, 255, 0.05); 
                        border: 1px solid #00e5ff; border-radius: 4px; color: #e6e6e6; 
                        font-size: 0.9rem;">
          <div style="margin-top: 8px; font-size: 0.85rem; opacity: 0.7;">
            ${repos.length} Machines Available • Target: 601
          </div>
        </div>
      `;
      
      // Generate categorized HTML
      let categorizedHTML = '';
      
      // Core Machines
      categorizedHTML += createCategory('Core Machines', categories.core, 'core', true);
      
      // Alphabet Machines
      categorizedHTML += createCategory('Alphabet Machines (A-Z)', categories.alphabet, 'alphabet', false);
      
      // Brain Nodes
      categorizedHTML += createCategory('Brain Network Nodes', categories.brains, 'brains', false);
      
      // Utility Machines
      categorizedHTML += createCategory('Utility & Support', categories.utility, 'utility', false);
      
      // Sandbox Machines
      categorizedHTML += createCategory('Sandbox Development', categories.sandbox, 'sandbox', false);
      
      container.innerHTML = searchHTML + categorizedHTML;
      
      // Add category toggle functionality
      document.querySelectorAll('.category-header').forEach(header => {
        header.addEventListener('click', function() {
          const categoryId = this.getAttribute('data-category');
          const content = document.getElementById(`category-${categoryId}`);
          const toggle = this.querySelector('.category-toggle');
          
          if (content.classList.contains('expanded')) {
            content.classList.remove('expanded');
            this.classList.remove('expanded');
          } else {
            content.classList.add('expanded');
            this.classList.add('expanded');
          }
        });
      });
      
      // Add search functionality
      document.getElementById('repoSearch').addEventListener('input', function(e) {
        const searchTerm = e.target.value.toLowerCase();
        const links = container.querySelectorAll('.repo-link');
        let visibleCount = 0;
        
        links.forEach(link => {
          const name = link.getAttribute('data-name');
          const desc = link.getAttribute('data-desc');
          if (name.includes(searchTerm) || desc.includes(searchTerm)) {
            link.style.display = 'block';
            visibleCount++;
          } else {
            link.style.display = 'none';
          }
        });
        
        // Expand all categories when searching
        if (searchTerm) {
          document.querySelectorAll('.category-content').forEach(c => c.classList.add('expanded'));
          document.querySelectorAll('.category-header').forEach(h => h.classList.add('expanded'));
        }
      });
    } catch (error) {
      console.error('Failed to load repo links:', error);
      document.getElementById('repoLinks').innerHTML = '<p style="color: #ff6b6b;">Failed to load repository links</p>';
    }
  }
  
  function createCategory(title, repos, categoryId, expanded = false) {
    if (repos.length === 0) return '';
    
    const expandedClass = expanded ? 'expanded' : '';
    
    return `
      <div class="category-header ${expandedClass}" data-category="${categoryId}">
        <span>${title}</span>
        <span>
          <span class="category-count">${repos.length}</span>
          <span class="category-toggle">▶</span>
        </span>
      </div>
      <div id="category-${categoryId}" class="category-content ${expandedClass}">
        ${repos.map(repo => `
          <a href="${repo.url}" class="repo-link" target="_blank" rel="noopener noreferrer" 
             data-name="${repo.name.toLowerCase()}" data-desc="${(repo.description || '').toLowerCase()}">
            <span class="repo-name">${repo.name}</span>
            <span class="repo-desc">${repo.description || 'Machine Repository - Ready for activation'}</span>
          </a>
        `).join('')}
      </div>
    `;
  }

  function toggleMenu() {
    document.getElementById('hamburgerMenu').classList.toggle('active');
  }

  // Initialize on page load
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', loadRepoLinks);
  } else {
    loadRepoLinks();
  }
</script>
